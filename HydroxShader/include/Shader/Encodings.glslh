vec2 encodeNormal(in vec3 normal)
{
	return normal.z != 1.0f ? (normal.z * 0.5f + 0.5f) * normalize(normal.xy + 0.00001f) : vec2(1.0f, 0.0f);
}

vec3 decodeNormal(in vec2 normal)
{
	float z = length(normal) * 2.0f - 1.0f;
	return vec3(sqrt((1.0f - z * z) / (dot(normal, normal) + 0.00001f)) * normal, z);
}
